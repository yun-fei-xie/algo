package _0_dp

import (
	"fmt"
	"math"
	"testing"
)

/*
938.æœ€ä½ç¥¨ä»·
https://leetcode.cn/problems/minimum-cost-for-tickets/?envType=study-plan-v2&envId=dynamic-programming
åœ¨ä¸€ä¸ªç«è½¦æ—…è¡Œå¾ˆå—æ¬¢è¿çš„å›½åº¦ï¼Œä½ æå‰ä¸€å¹´è®¡åˆ’äº†ä¸€äº›ç«è½¦æ—…è¡Œã€‚åœ¨æ¥ä¸‹æ¥çš„ä¸€å¹´é‡Œï¼Œä½ è¦æ—…è¡Œçš„æ—¥å­å°†ä»¥ä¸€ä¸ªåä¸º days çš„æ•°ç»„ç»™å‡ºã€‚æ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªä» 1 åˆ° 365 çš„æ•´æ•°ã€‚

ç«è½¦ç¥¨æœ‰ ä¸‰ç§ä¸åŒçš„é”€å”®æ–¹å¼ ï¼š

ä¸€å¼  ä¸ºæœŸä¸€å¤© çš„é€šè¡Œè¯å”®ä»·ä¸º costs[0] ç¾å…ƒï¼›
ä¸€å¼  ä¸ºæœŸä¸ƒå¤© çš„é€šè¡Œè¯å”®ä»·ä¸º costs[1] ç¾å…ƒï¼›
ä¸€å¼  ä¸ºæœŸä¸‰åå¤© çš„é€šè¡Œè¯å”®ä»·ä¸º costs[2] ç¾å…ƒã€‚
é€šè¡Œè¯å…è®¸æ•°å¤©æ— é™åˆ¶çš„æ—…è¡Œã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç¬¬ 2 å¤©è·å¾—ä¸€å¼  ä¸ºæœŸ 7 å¤© çš„é€šè¡Œè¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿ç€æ—…è¡Œ 7 å¤©ï¼šç¬¬ 2 å¤©ã€ç¬¬ 3 å¤©ã€ç¬¬ 4 å¤©ã€ç¬¬ 5 å¤©ã€ç¬¬ 6 å¤©ã€ç¬¬ 7 å¤©å’Œç¬¬ 8 å¤©ã€‚

è¿”å› ä½ æƒ³è¦å®Œæˆåœ¨ç»™å®šçš„åˆ—è¡¨ days ä¸­åˆ—å‡ºçš„æ¯ä¸€å¤©çš„æ—…è¡Œæ‰€éœ€è¦çš„æœ€ä½æ¶ˆè´¹ ã€‚



ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šdays = [1,4,6,7,8,20], costs = [2,7,15]
è¾“å‡ºï¼š11
è§£é‡Šï¼š
ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ç§è´­ä¹°é€šè¡Œè¯çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ å®Œæˆä½ çš„æ—…è¡Œè®¡åˆ’ï¼š
åœ¨ç¬¬ 1 å¤©ï¼Œä½ èŠ±äº† costs[0] = $2 ä¹°äº†ä¸€å¼ ä¸ºæœŸ 1 å¤©çš„é€šè¡Œè¯ï¼Œå®ƒå°†åœ¨ç¬¬ 1 å¤©ç”Ÿæ•ˆã€‚
åœ¨ç¬¬ 3 å¤©ï¼Œä½ èŠ±äº† costs[1] = $7 ä¹°äº†ä¸€å¼ ä¸ºæœŸ 7 å¤©çš„é€šè¡Œè¯ï¼Œå®ƒå°†åœ¨ç¬¬ 3, 4, ..., 9 å¤©ç”Ÿæ•ˆã€‚
åœ¨ç¬¬ 20 å¤©ï¼Œä½ èŠ±äº† costs[0] = $2 ä¹°äº†ä¸€å¼ ä¸ºæœŸ 1 å¤©çš„é€šè¡Œè¯ï¼Œå®ƒå°†åœ¨ç¬¬ 20 å¤©ç”Ÿæ•ˆã€‚
ä½ æ€»å…±èŠ±äº† $11ï¼Œå¹¶å®Œæˆäº†ä½ è®¡åˆ’çš„æ¯ä¸€å¤©æ—…è¡Œã€‚
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šdays = [1,2,3,4,5,6,7,8,9,10,30,31], costs = [2,7,15]
è¾“å‡ºï¼š17
è§£é‡Šï¼š
ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ç§è´­ä¹°é€šè¡Œè¯çš„æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ å®Œæˆä½ çš„æ—…è¡Œè®¡åˆ’ï¼š
åœ¨ç¬¬ 1 å¤©ï¼Œä½ èŠ±äº† costs[2] = $15 ä¹°äº†ä¸€å¼ ä¸ºæœŸ 30 å¤©çš„é€šè¡Œè¯ï¼Œå®ƒå°†åœ¨ç¬¬ 1, 2, ..., 30 å¤©ç”Ÿæ•ˆã€‚
åœ¨ç¬¬ 31 å¤©ï¼Œä½ èŠ±äº† costs[0] = $2 ä¹°äº†ä¸€å¼ ä¸ºæœŸ 1 å¤©çš„é€šè¡Œè¯ï¼Œå®ƒå°†åœ¨ç¬¬ 31 å¤©ç”Ÿæ•ˆã€‚
ä½ æ€»å…±èŠ±äº† $17ï¼Œå¹¶å®Œæˆäº†ä½ è®¡åˆ’çš„æ¯ä¸€å¤©æ—…è¡Œã€‚

æ–¹æ³•ï¼š
æšä¸¾æ¯ä¸€æ¬¡å‡ºå‘å‰æ˜¯å¦ä¹°ç¥¨
1. å¦‚æœéœ€è¦ä¹°ç¥¨ï¼Œä¹°å“ªç§ç¥¨
2. æœ‰4ç§æšä¸¾æƒ…å†µï¼ˆä¸ä¹°ç¥¨ã€ä¹°ç§ç±»1ã€ä¹°ç§ç±»2ã€ä¹°ç§ç±»3ï¼‰

å¦‚æœå½“å‰ä¹°å…¥æŸç§ç¥¨ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“è¿‡äº†å¤šé•¿æ—¶é—´æ‰éœ€è¦ä¹°ä¸‹ä¸€å¼ ç¥¨

*/

// è¿™ä¸ªå†™æ³•å¾ˆèˆ’æœï¼Œä½†æ˜¯åº”è¯¥è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´
func mincostTickets(days []int, costs []int) int {
	// iè¡¨ç¤ºdaysæ•°ç»„çš„ç´¢å¼•ï¼Œexpiredè¡¨ç¤ºä¸Šä¸€å¼ ç¥¨çš„æœ‰æ•ˆæœŸ
	var ans int = math.MaxInt
	var dfs func(i int, expired int, cost int)
	dfs = func(i int, expired int, cost int) {
		if i >= len(days) {
			if cost < ans {
				ans = cost
			}
			return
		}
		// ä¸éœ€è¦ä¹°ç¥¨
		if expired >= days[i] {
			dfs(i+1, expired, cost)
		} else {
			// éœ€è¦ä¹°ç¥¨
			dfs(i+1, days[i]+0, cost+costs[0])
			dfs(i+1, days[i]+6, cost+costs[1])
			dfs(i+1, days[i]+29, cost+costs[2])
		}
	}
	dfs(0, 0, 0)
	return ans
}

// ä¿®æ”¹é€’å½’å‡½æ•° ä»åå‘å‰æ€è€ƒğŸ¤”å°±ä¸ç”¨æ€è€ƒå‰é¢çš„çŠ¶æ€ï¼Œå› ä¸ºå‰é¢çš„çŠ¶æ€ä¾èµ–å½“å‰çš„çŠ¶æ€
func mincostTickets2(days []int, costs []int) int {
	// days[i...len-1]è¿™ä¸ªèŒƒå›´ä¹°ç¥¨éœ€è¦çš„æœ€å°èŠ±è´¹
	var dfs func(i int) int
	dfs = func(i int) int {
		// æ²¡æœ‰æ—…è¡Œï¼Œä¸éœ€è¦ä»»ä½•èŠ±è´¹
		if i >= len(days) {
			return 0
		}
		// æšä¸¾å½“å‰å¯èƒ½éœ€è¦çš„èŠ±è´¹æ•°é‡
		// ä¹°costs[0]
		c0 := costs[0] + dfs(i+1)
		// ä¸‹ä¸€æ¬¡éœ€è¦ä¹°ç¥¨çš„æ—¶é—´
		var j int
		for j = i + 1; j < len(days); j++ {
			if days[j] > days[i]+7-1 {
				break
			}
		}
		c1 := costs[1] + dfs(j)
		// ä¸‹ä¸€æ¬¡éœ€è¦ä¹°ç¥¨çš„æ—¶é—´
		var k int
		for k = i + 1; k < len(days); k++ {
			if days[k] > days[i]+30-1 {
				break
			}
		}
		c2 := costs[2] + dfs(k)
		return min(c0, c1, c2)
	}
	return dfs(0)
}

/*
è®°å¿†åŒ–
*/
func mincostTickets3(days []int, costs []int) int {
	// days[i...len-1]è¿™ä¸ªèŒƒå›´ä¹°ç¥¨éœ€è¦çš„æœ€å°èŠ±è´¹
	var mem = make([]int, len(days))
	for i := 0; i < len(days); i++ {
		mem[i] = -1
	}
	var dfs func(i int) int
	dfs = func(i int) int {
		// æ²¡æœ‰æ—…è¡Œï¼Œä¸éœ€è¦ä»»ä½•èŠ±è´¹
		if i >= len(days) {
			return 0
		}
		if mem[i] != -1 {
			return mem[i]
		}

		// æšä¸¾å½“å‰å¯èƒ½éœ€è¦çš„èŠ±è´¹æ•°é‡
		// ä¹°costs[0]
		c0 := costs[0] + dfs(i+1)
		// ä¸‹ä¸€æ¬¡éœ€è¦ä¹°ç¥¨çš„æ—¶é—´
		var j int
		for j = i + 1; j < len(days); j++ {
			if days[j] > days[i]+7-1 {
				break
			}
		}
		c1 := costs[1] + dfs(j)
		// ä¸‹ä¸€æ¬¡éœ€è¦ä¹°ç¥¨çš„æ—¶é—´
		var k int
		for k = i + 1; k < len(days); k++ {
			if days[k] > days[i]+30-1 {
				break
			}
		}
		c2 := costs[2] + dfs(k)
		mem[i] = min(c0, c1, c2)
		return mem[i]
	}
	return dfs(0)
}

func TestMinCostTickets(t *testing.T) {
	fmt.Println(mincostTickets([]int{1, 4, 6, 7, 8, 20}, []int{2, 7, 15}))
	fmt.Println(mincostTickets([]int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 30, 31}, []int{2, 7, 15}))
	fmt.Println(mincostTickets2([]int{1, 4, 6, 7, 8, 20}, []int{2, 7, 15}))
	fmt.Println(mincostTickets2([]int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 30, 31}, []int{2, 7, 15}))
}
